---
wave: 2
autonomous: false
---

# Phase 3 Plan 3: Approve/Reject Actions

**Summary**: Add approve and reject action buttons to BatchReview table rows with confirmation dialog for rejections (requires reason input).

## Goal Backward

**Phase Goal**: Operator can review batch, approve/reject samples, filter/sort results

**This Plan Must Deliver**:
- User can click Approve on any sample row
- User can click Reject on any sample row
- Reject shows dialog requiring reason input
- Table updates to show new status after action
- Toast notifications for success/failure

## Must-Haves (What Must Be TRUE)

### Truths
- Each sample row has Approve and Reject buttons
- Approve button calls approveSample API and refreshes data
- Reject button opens dialog with reason input
- Reject dialog submits to rejectSample API with reason
- Status badge updates after action completes
- Only pending/calculated samples show action buttons

### Artifacts
- `src/components/BatchReview.tsx`: Action column with buttons
- `src/components/RejectDialog.tsx`: Dialog for entering rejection reason
- TanStack Query mutation hooks for approve/reject

### Key Links
- Approve button → approveSample() → invalidate query → table refreshes
- Reject button → open RejectDialog → submit → rejectSample() → invalidate → refresh
- sonner toast for success/error feedback

## Tasks

### Task 1: Add TanStack Query mutations for approve/reject

**Objective**: Mutation hooks for approval workflow

**Checklist**:
- [ ] useApproveSample mutation hook
- [ ] useRejectSample mutation hook
- [ ] Both invalidate samples query on success
- [ ] Error handling with toast notifications

**Commit**: `feat(03-03): add approve and reject mutation hooks`

### Task 2: Create RejectDialog component

**Objective**: Modal dialog for entering rejection reason

**Checklist**:
- [ ] Dialog with textarea for reason
- [ ] Required validation (reason cannot be empty)
- [ ] Cancel and Submit buttons
- [ ] Disable submit while mutation pending

**Commit**: `feat(03-03): add RejectDialog component`

### Task 3: Add action buttons to BatchReview table

**Objective**: Approve/Reject UI in each row

**Checklist**:
- [ ] Add Actions column to table
- [ ] Approve button (CheckCircle icon) - calls mutation directly
- [ ] Reject button (XCircle icon) - opens RejectDialog
- [ ] Hide buttons for already approved/rejected samples
- [ ] Loading state on buttons during mutation
- [ ] checkpoint:human-verify - User tests approve/reject flow

**Commit**: `feat(03-03): add approve and reject action buttons to BatchReview`

## Verification

checkpoint:human-verify

1. Open BatchReview with samples in "calculated" status
2. Click Approve on a sample - verify status changes to "approved"
3. Click Reject on a sample - verify dialog opens
4. Enter reason and submit - verify status changes to "rejected"
5. Verify approved/rejected samples no longer show action buttons

## Dependencies

- Requires: 03-01 (backend APIs), 03-02 (BatchReview table)
- Provides: Complete approve/reject workflow
- Affects: 03-04 (filter can use status)

## Scope

- Tasks: 3
- Estimated context: 35%
